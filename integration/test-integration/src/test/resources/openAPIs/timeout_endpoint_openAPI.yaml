openapi: "3.0.0"
info:
  version: 1.0.0
  title: Endpoint Timeout
  license:
    name: MIT
servers:
  - url: http://mockBackend:2383/v3
x-wso2-basePath: /endpoint-timeout

x-wso2-production-endpoints:
  urls:
    - http://mockBackend:2383/v2
  advanceEndpointConfig:
    timeoutInMillis: 5000 # 5s API level timeout
x-wso2-sandbox-endpoints:
  urls:
    - http://mockBackend:2390/v2
  advanceEndpointConfig:
    timeoutInMillis: 5000 # 5s API level timeout

paths:
  /pet/findByStatus:
    x-wso2-production-endpoints:
      urls:
        - http://mockBackend:2383/v2
      advanceEndpointConfig:
        timeoutInMillis: 2000 # 2s Resource level timeout
    x-wso2-sandbox-endpoints:
      urls:
        - http://mockBackend:2390/v2
      advanceEndpointConfig:
        timeoutInMillis: 2000 # 2s Resource level timeout
    get:
      summary: Responds without a delay. Does not trigger any timeout.
      produces:
        - application/json
      responses:
        200:
          schema:
            type: array
            items:
              $ref: '#/definitions/Pet'
  /delay-3:
    x-wso2-production-endpoints:
      urls:
        - http://mockBackend:2383/v2
      advanceEndpointConfig:
        timeoutInMillis: 2000 # 2s Resource level timeout
    x-wso2-sandbox-endpoints:
      urls:
        - http://mockBackend:2390/v2
      advanceEndpointConfig:
        timeoutInMillis: 2000 # 2s Resource level timeout
    get:
      summary: Responds with a 3s delay. Triggers timeout due to resource level config.
      produces:
        - application/json
      responses:
        200:
          schema:
            type: array
            items:
              $ref: '#/definitions/Pet'
  /delay-4:
    get:
      summary: Responds with a 4s delay. Does not trigger any timeout.
      produces:
        - application/json
      responses:
        200:
          schema:
            type: array
            items:
              $ref: '#/definitions/Pet'
  /delay-6:
    get:
      summary: Responds with a 6s delay. Triggers timeout due to API level config.
      produces:
        - application/json
      responses:
        200:
          schema:
            type: array
            items:
              $ref: '#/definitions/Pet'
components:
  schemas:
    Pet:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        tag:
          type: string

